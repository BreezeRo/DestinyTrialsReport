<div class="home__content">
  <article class="home__main">
    <div class="maps block blog-post shadow-z-1 {{mapInfoAnimClass}}">
      <div class="modal-hero blog-image" ng-style="{'background-image':'url(' + currentMapInfo.pgcrImage + ')'}">
        <div class="modal-hero__header">
          <h2 class="modal-hero__title" ng-bind="currentMapInfo.name"></h2>
          <p class="modal-hero__description stat" ng-bind="currentMapInfo.weekText"></p>
        </div>
        <div class="modal-hero__switch">
          <div class="modal-hero__switch__btns">
            <a href="#" ng-style="{'opacity': showPrev ? '1' : '.2' }" ng-click="toggleDirection('left')"><i class="material-icons">&#xE5CB;</i></a>
            <a href="#" ng-style="{'opacity': showNext ? '1' : '.2' }" ng-click="toggleDirection('right')"><i class="material-icons">&#xE5CC;</i></a>
          </div>
          <label>Other weeks</label>
        </div>
      </div>
      <div class="blog-post__content" ng-if="currentMapInfo">
        <div class="row">
          <div class="col-xs-6 col-md-3 stat">
            <span ng-bind="currentMapInfo.lighthouse | number"></span>
            <label>Flawless runs</label>
          </div>
          <div class="col-xs-6 col-md-3 stat">
            <span ng-bind="currentMapInfo.players | number"></span>
            <label>Guardians participated</label>
          </div>
          <div class="col-xs-6 col-md-3 stat">
            <span ng-bind="currentMapInfo.matches | number"></span>
            <label>Total matches</label>
          </div>
          <div class="col-xs-6 col-md-3 stat">
            <span ng-bind="currentMapInfo.kills | number"></span>
            <label>Total kills</label>
          </div>
        </div>
        <hr>
        <div class="row" ng-if="currentMapInfo.heatmapImage || currentMapInfo.mapImage">
          <div class="col-xs-2">
            <h3 class="stat-header">
              Info
            </h3>
          </div>
          <div class="col-xs-10">
            <button type="button" class="btn btn-inline btn-raised btn-sm" ng-if="currentMapInfo.heatmapImage"
                    data-template-url="shared/modals/heatmap.modal.html" bs-modal>
              Heatmap
            </button>
            <button type="button" class="btn btn-inline btn-raised btn-sm" ng-if="currentMapInfo.mapImage"
                    data-template-url="shared/modals/map.modal.html" bs-modal>
              Map Overview
            </button>
          </div>
        </div>
        <hr>
        <div class="row" ng-if="currentMapInfo">
          <div class="col-xs-2">
            <h3 class="stat-header">
              Weapon usage on this map
            </h3>
            <span
               data-content="{{'Weapon usage during Trials of Osiris on ' + (currentMap.name || 'this map') + ' compared to all maps'}}" bs-popover>
              <i class="material-icons icon--small info">&#xE8FD;</i>
            </span>
          </div>
          <div class="col-xs-12 col-sm-4" ng-repeat="(key, weapons) in weaponSummary track by $index"
               ng-class="{'col-sm-offset-1': $index > 0}">
            <div class="top-weapons--map">
              <div class="row">
                <div class="col-xs-6 col-sm-4">
                  <label class="top-weapons__label" ng-bind="key"></label>
                </div>
                <div class="col-xs-3 col-sm-4 stat">
                  <label>Kills</label>
                </div>
                <div class="col-xs-3 col-sm-4 stat">
                  <label>Diff. to avg</label>
                </div>
              </div>
              <div class="row top-weapons--map__row" ng-repeat="weapon in weapons">
                <div class="col-xs-6 col-sm-4">
                  <img class="weapon-type-icon img-responsive"
                       ng-src="{{'assets/img/weapon-icons/' + weapon.weapon_type.toLowerCase().replace(' ','-') + '.svg'}}"
                       alt="{{weapon.weapon_type}}">
                </div>
                <div class="col-xs-3 col-sm-4 stat">
                  <span ng-bind="weapon.killPercentage | number:2"></span>%
                </div>
                <div class="col-xs-3 col-sm-4 stat"
                     ng-class="{'success': weapon.diffPercentage > 0, 'fail': weapon.diffPercentage < 0}">
                  <i class="material-icons" ng-bind="weapon.diffPercentage > 0 ? '&#xE5CE;' : '&#xE5CF;'"></i>
                  <span ng-bind="weapon.diffPercentage | number:2"></span>%
                </div>
              </div>
              <hr class="visible-xs" ng-if="$index === 0">
            </div>
          </div>
        </div>
        <hr>
        <div class="row">
          <div class="col-xs-2">
            <h3 class="stat-header">
              Top weapons <span ng-bind="currentMapInfo.weekText"></span>
            </h3>
            <a
              href="http://guardian.gg"
              target="_blank"
              data-content="Kindly provided by Guardian.gg. Click here to head over there for the complete list and a lot more cool stats." bs-popover>
              <i class="material-icons icon--small info">&#xE148;</i>
            </a>
          </div>
          <div class="col-xs-12 col-sm-5" ng-repeat="type in [gggWeapons[platformNumeric].primary,
                                     gggWeapons[platformNumeric].special] track by $index">
            <div class="row top-weapon" ng-repeat="weapon in type track by $index" ng-if="$index < 3">
              <div class="col-xs-6 col-sm-7 last-weapon-weapon__descr">
                <img class="last-match-weapon__img img-responsive" ng-src="{{'https://www.bungie.net/' + weapon.icon}}" alt="{{weapon.name}}">
                <span class="last-match-weapon__title" ng-bind="weapon.name"></span>
              </div>
              <div class="col-xs-6 col-sm-5 stat">
                <span ng-bind="weapon.kills | number:2"></span>%
              </div>
            </div>
            <hr class="visible-xs" ng-if="$index === 0">
          </div>
        </div>
        <hr>
        <div class="row" ng-init="entry = lighthouseLeaderboard[0]">
          <div class="col-xs-2">
            <h3 class="stat-header">
              First players to reach the lighthouse
            </h3>
          </div>
          <div class="col-xs-3 stat first-in-lighthouse__players">
            <span ng-repeat="player in lighthouseLeaderboard[0].players track by $index">
              <a ng-href="https://my.trials.report/{{$parent.lighthouseLeaderboard[0].platform === 1 ? 'xbox' : 'ps'}}/{{player}}" ng-bind="player" target="_blank"></a>
            </span>
            <label>Player<span ng-if="lighthouseLeaderboard[0].players.length > 1">s</span></label>
          </div>
          <div class="col-xs-3 stat first-in-lighthouse__time">
            <span ng-bind="lighthouseLeaderboard[0].time"></span>
            <label>Time needed</label>
          </div>
          <div class="col-xs-3 first-in-lighthouse__stats">
            <div class="stat">
              <span ng-if="lighthouseLeaderboard[0].platform === 1">
                <img src="assets/img/xbox.svg" alt="Xbox">
              </span>
              <span ng-if="lighthouseLeaderboard[0].platform === 2">
                <img src="assets/img/ps.svg" alt="PlayStation">
              </span>
              <label>Platform</label>
            </div>
          </div>
        </div>
      </div>
    </div>
  </article>
  <div class="home__aside">
    <div ng-include="'components/home/aside.partial.html'"></div>
  </div>
</div>
